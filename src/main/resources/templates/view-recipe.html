<!DOCTYPE html>
<html>
<head>
    <title>Recipe Details - RecipeVault</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sanitize-html@2.9.0/dist/sanitize-html.min.js"></script>
    <style>
        /* Base Styles */
        :root {
            --primary: #2c7be5;
            --primary-dark: #1a68d1;
            --primary-light: #5995e8;
            --secondary: #33b07c;
            --background-dark: #121212;
            --background: #1e1e1e;
            --background-light: #2d2d2d;
            --card-bg: #262626;
            --text: #e9ecef;
            --text-muted: #adb5bd;
            --text-secondary: #83888e;
            --border: #383838;
            --error: #e63757;
            --success: #33b07c;
            --card-radius: 8px;
            --transition: all 0.25s cubic-bezier(0.25, 0.8, 0.25, 1);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.18);
        }
        
        /* Light theme variables */
        [data-theme="light"] {
            --primary: #1e62c0;
            --primary-dark: #1754a3;
            --primary-light: #4785d6;
            --secondary: #2a9363;
            --background-dark: #e9ecef;
            --background: #f8f9fa;
            --background-light: #ffffff;
            --card-bg: #ffffff;
            --text: #212529;
            --text-muted: #6c757d;
            --text-secondary: #495057;
            --border: #dee2e6;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.12);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--background);
            color: var(--text);
            margin: 0;
            padding: 0;
            line-height: 1.5;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: var(--background-dark);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--background-light);
            border-radius: 6px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #505050;
        }
        
        /* Container */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Header */
        header {
            background: var(--background-dark);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
        }
        
        .logo {
            font-size: 1.6rem;
            color: var(--primary);
            margin-right: 0.8rem;
            transform-origin: center;
            transition: color 0.3s ease;
        }
        
        .brand {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text);
            margin: 0;
            letter-spacing: -0.02em;
            transition: color 0.3s ease;
        }
        
        .tagline {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 400;
            margin-top: 0.2rem;
            letter-spacing: 0.01em;
            transition: color 0.3s ease;
        }
        
        /* Recipe Details */
        .recipe-header {
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .recipe-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            line-height: 1.2;
            transition: color 0.3s ease;
        }
        
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 1rem;
        }
        
        .tag {
            display: inline-block;
            background-color: rgba(44, 123, 229, 0.15);
            color: var(--primary);
            font-size: 0.75rem;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            transition: var(--transition);
            font-weight: 500;
        }
        
        [data-theme="light"] .tag {
            background-color: rgba(44, 123, 229, 0.1);
        }
        
        .tag:hover {
            background-color: rgba(44, 123, 229, 0.25);
        }
        
        .recipe-card {
            background: var(--card-bg);
            border-radius: var(--card-radius);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            border: 1px solid var(--border);
            margin-bottom: 2rem;
        }
        
        .section {
            padding: 2rem;
            border-bottom: 1px solid var(--border);
        }
        
        .section:last-child {
            border-bottom: none;
        }
        
        .section-title {
            color: var(--primary);
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .section-title i {
            font-size: 1.2rem;
        }
        
        .ingredients-list, .instructions {
            color: var(--text);
            line-height: 1.7;
            font-size: 1rem;
        }
        
        /* AI Sections */
        .ai-section {
            background-color: rgba(44, 123, 229, 0.08);
            border-radius: var(--card-radius);
            padding: 1.5rem;
            margin-top: 2rem;
            border-left: 4px solid var(--primary);
            transition: background-color 0.3s ease;
        }
        
        [data-theme="light"] .ai-section {
            background-color: rgba(44, 123, 229, 0.05);
        }
        
        .ai-title {
            color: var(--primary);
            font-weight: 600;
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .ai-title i {
            margin-right: 0.5rem;
        }
        
        /* Ingredient Alternatives */
        .ingredient-item {
            margin-bottom: 1rem;
            padding: 0.8rem;
            background-color: var(--background-light);
            border-radius: 6px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .ingredient-item:hover {
            background-color: rgba(44, 123, 229, 0.1);
        }
        
        .alternative-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
            opacity: 0.9;
        }
        
        .alternative-btn:hover {
            background: var(--primary-dark);
            opacity: 1;
        }
        
        /* Allergy Form */
        .allergy-form {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background-color: var(--background-light);
            border-radius: var(--card-radius);
            transition: background-color 0.3s ease;
        }
        
        .allergy-form h3 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--text);
            font-weight: 600;
        }
        
        .form-group {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .form-input {
            flex: 1;
            min-width: 200px;
            padding: 0.8rem 1rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--background);
            color: var(--text);
            outline: none;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .form-input:focus {
            border-color: var(--primary-light);
            box-shadow: 0 0 0 1px rgba(44, 123, 229, 0.2);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            font-size: 0.9rem;
            gap: 0.5rem;
            letter-spacing: 0.01em;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            box-shadow: 0 4px 10px rgba(44, 123, 229, 0.4);
            transform: translateY(-1px);
        }
        
        .loading {
            display: inline-block;
            margin-left: 0.5rem;
            font-style: italic;
            color: var(--primary);
            font-size: 0.9rem;
        }
        
        .results-container {
            margin-top: 1rem;
            padding: 1rem;
            background-color: var(--background);
            border-radius: 6px;
            display: none;
            border: 1px solid var(--border);
        }
        
        /* Back Button */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            margin-top: 2rem;
            transition: var(--transition);
        }
        
        .back-link:hover {
            color: var(--primary-dark);
            transform: translateX(-3px);
        }
        
        /* Footer */
        footer {
            background: var(--background-dark);
            padding: 1.5rem;
            margin-top: 4rem;
            text-align: center;
            border-top: 1px solid var(--border);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .footer-text {
            color: var(--text-secondary);
            font-size: 0.85rem;
            transition: color 0.3s ease;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 0.8rem;
        }
        
        .footer-link {
            color: var(--text-secondary);
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.85rem;
        }
        
        .footer-link:hover {
            color: var(--primary);
        }
        
        /* Theme toggle */
        .theme-toggle {
            background: var(--background-light);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            height: 36px;
            width: 36px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .theme-toggle:hover {
            background: var(--border);
            color: var(--text);
        }
        
        /* Markdown content styling */
        .markdown-content h1, 
        .markdown-content h2, 
        .markdown-content h3 {
            color: var(--primary);
            margin-top: 1.2em;
            margin-bottom: 0.6em;
        }
        
        .markdown-content ul, 
        .markdown-content ol {
            padding-left: 1.5em;
            margin-bottom: 1em;
        }
        
        .markdown-content li {
            margin-bottom: 0.5em;
        }
        
        .markdown-content p {
            margin-bottom: 1em;
        }
        
        .markdown-content a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .markdown-content a:hover {
            text-decoration: underline;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .reveal {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }
        
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
                padding: 0.5rem 0;
            }
            
            .logo-container {
                justify-content: center;
            }
            
            .container {
                padding: 1.5rem;
            }
            
            .recipe-title {
                font-size: 1.8rem;
            }
            
            .section {
                padding: 1.5rem;
            }
            
            .form-group {
                flex-direction: column;
            }
            
            .form-input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-container">
                <div class="logo"><i class="fas fa-book-bookmark"></i></div>
                <div>
                    <h1 class="brand">RecipeVault</h1>
                    <p class="tagline">Professional Recipe Management with AI</p>
                </div>
            </div>
            <button class="theme-toggle" id="themeToggle" title="Toggle dark/light mode">
                <i class="fas fa-sun"></i>
            </button>
        </div>
    </header>

    <div class="container">
        <div class="recipe-header reveal">
            <h1 class="recipe-title" id="recipeTitle">Homemade Pasta Carbonara</h1>
            <div class="tags-container" id="recipeTags">
                <span class="tag">Italian</span>
                <span class="tag">Pasta</span>
                <span class="tag">Dinner</span>
            </div>
        </div>

        <div class="recipe-card reveal">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-list"></i> Ingredients</h2>
                <div class="ingredients-list markdown-content" id="ingredientsList">
                    Loading ingredients...
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title"><i class="fas fa-utensils"></i> Instructions</h2>
                <div class="instructions markdown-content" id="instructionsList">
                    Loading instructions...
                </div>
            </div>
        </div>
        
        <div class="ai-section reveal">
            <div class="ai-title"><i class="fas fa-brain"></i> Health Tips</div>
            <div id="healthTipsContent" class="markdown-content">
                Loading health tips...
            </div>
        </div>
        
        <div class="recipe-card reveal">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-exchange-alt"></i> Ingredient Alternatives</h2>
                <p>Select an ingredient to see alternatives:</p>
                
                <div id="processedIngredients" class="reveal">
                    <!-- Ingredient items will be generated here -->
                </div>
                
                <div id="alternativeResults" class="results-container markdown-content">
                    Select an ingredient to see alternatives.
                </div>
                
                <div class="allergy-form reveal">
                    <h3>Get Allergy-Safe Substitutes</h3>
                    <div class="form-group">
                        <input type="text" id="ingredient" class="form-input" placeholder="Enter ingredient">
                        <input type="text" id="allergies" class="form-input" placeholder="Enter allergies (e.g., nuts, dairy)">
                        <button id="allergyBtn" class="btn btn-primary">
                            <i class="fas fa-search"></i> Get Substitutes
                        </button>
                    </div>
                    <span id="allergyLoading" class="loading" style="display:none;">Thinking...</span>
                    <div id="allergyResults" class="results-container markdown-content">
                        Enter an ingredient and allergies to find safe substitutes.
                    </div>
                </div>
            </div>
        </div>
        
        <a href="/" class="back-link">
            <i class="fas fa-arrow-left"></i> Back to Recipes
        </a>
    </div>

    <footer>
        <div class="footer-content">
            <p class="footer-text">© 2025 RecipeVault - Enterprise Recipe Management Solution</p>
            <div class="footer-links">
                <a href="#" class="footer-link">About</a>
                <a href="#" class="footer-link">Terms</a>
                <a href="#" class="footer-link">Privacy</a>
                <a href="#" class="footer-link">Support</a>
            </div>
        </div>
    </footer>

    <script>
        // Sample recipe data (in a real app, this would come from the server)
        const recipeData = {
            title: "Homemade Pasta Carbonara",
            tags: ["Italian", "Pasta", "Dinner"],
            ingredients: `- 400g spaghetti
- 200g pancetta or guanciale, diced
- 4 large eggs
- 100g Pecorino Romano cheese, grated
- 100g Parmigiano Reggiano, grated
- 2 cloves garlic, minced
- Freshly ground black pepper
- Salt to taste
- Fresh parsley, chopped (for garnish)`,
            instructions: `1. Bring a large pot of salted water to a boil. Add the spaghetti and cook until al dente according to package instructions.

2. While the pasta is cooking, heat a large skillet over medium heat. Add the diced pancetta or guanciale and cook until crispy and the fat has rendered, about 8-10 minutes.

3. In a bowl, whisk together the eggs, grated cheeses, and a generous amount of freshly ground black pepper.

4. When the pasta is done, reserve 1 cup of the pasta water, then drain the pasta.

5. Working quickly, add the hot pasta to the skillet with the pancetta. Toss to coat the pasta in the rendered fat.

6. Remove the skillet from the heat and quickly pour in the egg and cheese mixture, stirring constantly to create a creamy sauce. If the sauce is too thick, add a splash of the reserved pasta water to thin it out.

7. Serve immediately, garnished with additional grated cheese, freshly ground black pepper, and chopped parsley.`,
            healthTips: `• Carbonara is a rich dish, so consider serving it with a light side salad to balance the meal.
• For a lighter version, you can use turkey bacon instead of pancetta and reduce the amount of cheese.
• Adding green peas or asparagus can introduce some vegetables to this classic dish.
• Whole wheat pasta can be substituted for regular pasta to increase the fiber content.
• This dish is high in protein from the eggs and cheese, making it quite satisfying.`
        };

        // Initialize markdown-it
        const md = window.markdownit({
            html: true,
            breaks: true,
            linkify: true,
            typographer: true
        });

        document.addEventListener('DOMContentLoaded', function() {
            // Theme toggle functionality
            const themeToggle = document.getElementById('themeToggle');
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
            
            // Check for saved theme preference or use preferred color scheme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.body.setAttribute('data-theme', savedTheme);
                updateThemeIcon(savedTheme);
            } else {
                // Use system preference as default
                const systemTheme = prefersDarkScheme.matches ? 'dark' : 'light';
                document.body.setAttribute('data-theme', systemTheme);
                updateThemeIcon(systemTheme);
            }
            
            // Update icon based on current theme
            function updateThemeIcon(theme) {
                const icon = themeToggle.querySelector('i');
                if (theme === 'light') {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                } else {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                }
            }
            
            // Toggle theme when button is clicked
            themeToggle.addEventListener('click', function() {
                const currentTheme = document.body.getAttribute('data-theme') || 'dark';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                // Apply theme change with animation
                anime({
                    targets: 'body',
                    opacity: [1, 0.96, 1],
                    duration: 300,
                    easing: 'easeInOutQuad',
                    begin: function() {
                        document.body.setAttribute('data-theme', newTheme);
                        localStorage.setItem('theme', newTheme);
                        updateThemeIcon(newTheme);
                    }
                });
            });
            
            // Populate recipe data
            document.getElementById('recipeTitle').textContent = recipeData.title;
            
            // Clear and populate tags
            const tagsContainer = document.getElementById('recipeTags');
            tagsContainer.innerHTML = '';
            recipeData.tags.forEach(tag => {
                const tagSpan = document.createElement('span');
                tagSpan.className = 'tag';
                tagSpan.textContent = tag;
                tagsContainer.appendChild(tagSpan);
            });
            
            // Format and render ingredients
            const ingredientsElement = document.getElementById('ingredientsList');
            ingredientsElement.innerHTML = md.render(recipeData.ingredients);
            
            // Format and render instructions
            const instructionsElement = document.getElementById('instructionsList');
            instructionsElement.innerHTML = md.render(recipeData.instructions);
            
            // Format and render health tips
            const healthTipsElement = document.getElementById('healthTipsContent');
            healthTipsElement.innerHTML = formatGeminiResponse(recipeData.healthTips);
            
            // Process ingredients for alternatives
            const processedIngredients = document.getElementById('processedIngredients');
            processedIngredients.innerHTML = '';
            
            // Parse ingredients from markdown
            const ingredientLines = recipeData.ingredients.split('\n')
                .filter(line => line.trim().startsWith('-'))
                .map(line => line.replace('-', '').trim());
            
            // Create interactive ingredient items
            ingredientLines.forEach((ingredient, index) => {
                // Extract the main ingredient name (before any commas or parentheses)
                const mainIngredient = ingredient.split(',')[0].split('(')[0].trim();
                
                // Remove quantities and measurements for the ingredient name
                const cleanedIngredient = mainIngredient.replace(/^\d+(\.\d+)?(g|kg|ml|l|cups?|tbsp|tsp|oz|pounds?|lbs?)?/i, '').trim();
                
                const itemDiv = document.createElement('div');
                itemDiv.className = 'ingredient-item reveal';
                itemDiv.innerHTML = `
                    <span>${ingredient}</span>
                    <button class="alternative-btn" onclick="getAlternative('${cleanedIngredient.replace(/'/g, "\\'")}')">
                        <i class="fas fa-exchange-alt"></i> Alternatives
                    </button>
                `;
                processedIngredients.appendChild(itemDiv);
                
                // Add staggered animation
                setTimeout(() => {
                    itemDiv.classList.add('active');
                }, 100 + index * 50);
            });
            
            // Set up allergy button
            document.getElementById('allergyBtn').addEventListener('click', getAllergySafeSubstitutes);
            
            // Reveal animations on scroll
            function revealOnScroll() {
                const reveals = document.querySelectorAll('.reveal:not(.active)');
                
                reveals.forEach((element, index) => {
                    const windowHeight = window.innerHeight;
                    const elementTop = element.getBoundingClientRect().top;
                    const elementVisible = 100;
                    
                    if (elementTop < windowHeight - elementVisible) {
                        setTimeout(() => {
                            element.classList.add('active');
                        }, index * 80);
                    }
                });
            }
            
            window.addEventListener('scroll', revealOnScroll);
            // Initial check for elements in viewport
            setTimeout(revealOnScroll, 100);
            
            // Subtle logo animation
            anime({
                targets: '.logo',
                scale: [
                    { value: 1.1, duration: 300, easing: 'easeOutQuad' },
                    { value: 1, duration: 300, easing: 'easeInOutQuad' }
                ],
                delay: 300
            });
        });
        
        // Helper function to format Gemini API responses
        function formatGeminiResponse(response) {
            // Split response into sections if it contains bullet points
            const lines = response.split('\n');
            let formattedResponse = '';

            // Check if response has bullet points
            const hasBulletPoints = lines.some(line => line.trim().startsWith('•') || line.trim().startsWith('-'));

            if (hasBulletPoints) {
                // Process each line
                lines.forEach(line => {
                    const trimmedLine = line.trim();
                    if (trimmedLine.startsWith('•') || trimmedLine.startsWith('-')) {
                        // Convert bullets to markdown list items
                        formattedResponse += `- ${trimmedLine.substring(1).trim()}\n`;
                    } else if (trimmedLine.length > 0) {
                        // Add paragraphs for non-list text
                        formattedResponse += `${trimmedLine}\n\n`;
                    }
                });
            } else {
                // Format as paragraphs if no bullet points
                formattedResponse = lines
                    .filter(line => line.trim().length > 0)
                    .join('\n\n');
            }

            // Render the markdown
            return md.render(formattedResponse);
        }
        
        // Function to get alternatives for an ingredient
        function getAlternative(ingredient) {
            const alternativeResults = document.getElementById('alternativeResults');
            
            // Show loading state
            alternativeResults.style.display = 'block';
            alternativeResults.innerHTML = `<p>Finding alternatives for <strong>${ingredient}</strong>...</p>`;
            
            // Simulate API call with setTimeout (in a real app, this would be a fetch to your backend)
            setTimeout(() => {
                // Sample alternatives data (in a real app, this would come from the API)
                let alternatives;
                
                switch(ingredient.toLowerCase()) {
                    case 'pancetta':
                    case 'guanciale':
                        alternatives = `
## Alternatives for Pancetta/Guanciale

- **Bacon**: The most common substitute, though it has a smokier flavor
- **Prosciutto**: Less fatty but adds a nice salty flavor
- **Smoked Ham**: Works well when diced finely
- **For Vegetarian Option**: Smoked tofu or tempeh with a bit of olive oil and salt
                        `;
                        break;
                    case 'pecorino romano':
                        alternatives = `
## Alternatives for Pecorino Romano

- **Parmigiano Reggiano**: Slightly milder but works well
- **Grana Padano**: Similar texture with a more delicate flavor
- **Aged Asiago**: Good substitute with a slightly sharper taste
- **For Dairy-Free Option**: Nutritional yeast mixed with a pinch of salt
                        `;
                        break;
                    case 'parmigiano reggiano':
                        alternatives = `
## Alternatives for Parmigiano Reggiano

- **Pecorino Romano**: Sharper and saltier
- **Grana Padano**: Very similar flavor profile
- **Aged Manchego**: Different but compatible flavor
- **For Dairy-Free Option**: Nutritional yeast with a bit of almond meal
                        `;
                        break;
                    case 'spaghetti':
                        alternatives = `
## Alternatives for Spaghetti

- **Linguine**: Slightly wider but works perfectly
- **Fettuccine**: Wider pasta that holds the sauce well
- **Bucatini**: Hollow spaghetti that adds an interesting texture
- **For Gluten-Free Option**: Rice noodles or gluten-free pasta
- **For Low-Carb Option**: Zucchini noodles or spaghetti squash
                        `;
                        break;
                    default:
                        alternatives = `
## Alternatives for ${ingredient}

- No specific alternatives found for this ingredient.
- Try searching for a more specific ingredient name.
                        `;
                }
                
                // Render the alternatives with markdown
                alternativeResults.innerHTML = md.render(alternatives);
                
                // Add animation
                anime({
                    targets: '#alternativeResults',
                    opacity: [0, 1],
                    translateY: [10, 0],
                    duration: 400,
                    easing: 'easeOutQuad'
                });
            }, 800);
        }
        
        // Function to get allergy-safe substitutes
        function getAllergySafeSubstitutes() {
            const ingredient = document.getElementById('ingredient').value.trim();
            const allergies = document.getElementById('allergies').value.trim();
            
            if (!ingredient || !allergies) {
                alert('Please enter both an ingredient and allergies');
                return;
            }
            
            const allergyResults = document.getElementById('allergyResults');
            const loadingElement = document.getElementById('allergyLoading');
            
            // Show loading state
            loadingElement.style.display = 'inline-block';
            allergyResults.style.display = 'block';
            allergyResults.innerHTML = 'Searching for allergy-safe substitutes...';
            
            // Simulate API call with setTimeout (in a real app, this would be a fetch to your backend)
            setTimeout(() => {
                // Sample response data (in a real app, this would come from the API)
                let response;
                
                if (ingredient.toLowerCase().includes('cheese') && allergies.toLowerCase().includes('dairy')) {
                    response = `
## Dairy-Free Alternatives for Cheese

- **Nutritional Yeast**: Provides a cheesy flavor without dairy
- **Cashew Cheese**: Made from soaked cashews, nutritional yeast, and seasonings
- **Coconut-Based Cheese**: Commercial options available in most grocery stores
- **Tofu-Based Cheese**: Good for recipes that require melting
                    `;
                } else if (ingredient.toLowerCase().includes('milk') && allergies.toLowerCase().includes('dairy')) {
                    response = `
## Dairy-Free Alternatives for Milk

- **Almond Milk**: Light flavor, works well in most recipes
- **Oat Milk**: Creamy texture, great for cooking
- **Coconut Milk**: Rich option, adds coconut flavor
- **Soy Milk**: Protein-rich alternative with neutral taste
                    `;
                } else if (ingredient.toLowerCase().includes('flour') && allergies.toLowerCase().includes('gluten')) {
                    response = `
## Gluten-Free Alternatives for Flour

- **Rice Flour**: Light texture, mild flavor
- **Almond Flour**: Adds moisture and nutty flavor
- **Chickpea Flour**: High protein content, good for savory dishes
- **Gluten-Free Flour Blend**: Commercial blends designed to substitute 1:1 for wheat flour
                    `;
                } else {
                    response = `
## Allergy-Safe Alternatives for ${ingredient}

Based on your allergies (${allergies}), consider these substitutes:

- Option 1: Alternative ingredient with similar properties
- Option 2: Different approach to achieve similar results
- Option 3: Complete replacement that avoids allergens

Always check product labels carefully as manufacturing processes may introduce cross-contamination.
                    `;
                }
                
                // Hide loading indicator
                loadingElement.style.display = 'none';
                
                // Render the response with markdown
                allergyResults.innerHTML = md.render(response);
                
                // Add animation
                anime({
                    targets: '#allergyResults',
                    opacity: [0, 1],
                    translateY: [10, 0],
                    duration: 400,
                    easing: 'easeOutQuad'
                });
            }, 1200);
        }
    </script>
</body>
</html>